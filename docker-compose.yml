version: '3'
services:
  backup:
    image: backend-backup:latest
    build: .
    environment:
      # MariaDB Configuration
      - MARIADB_HOST=${MARIADB_HOST:-mariadb}
      - MARIADB_USER=${MARIADB_USER:-root}
      - MARIADB_PASSWORD=${MARIADB_PASSWORD}
      
      # PostgreSQL Configuration
      - POSTGRES_HOST=${POSTGRES_HOST:-postgresql}
      - POSTGRES_USER=${POSTGRES_USER:-postgres}
      - POSTGRES_PASSWORD=${POSTGRES_PASSWORD}
      
      # Redis Configuration
      - REDIS_HOST=${REDIS_HOST:-redis}
      
      # Backup Settings
      - BACKUP_DIR=${BACKUP_DIR:-/backups}
      - RETENTION_DAYS=${RETENTION_DAYS:-7}
      - BACKUP_INTERVAL_MINUTES=${BACKUP_INTERVAL_MINUTES:-1440}
      
      # Timezone and User Settings
      - TZ=${TZ:-UTC}
      - PUID=${PUID:-1000}
      - PGID=${PGID:-1000}
    volumes:
      - ${BACKUP_DIR:-./backups}:/backups
    networks:
      - backend
    restart: unless-stopped

networks:
  backend:
    external: true